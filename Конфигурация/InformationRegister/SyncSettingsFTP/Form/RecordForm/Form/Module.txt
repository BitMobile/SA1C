
&AtServer
Function GetObjectNameList(StartValue)
	
	CurrentObjectList = New ValueList;
	
	If ValueIsFilled(StartValue) Then 
		CurrentObjectList.Add(StartValue);
	EndIf;
		
	MetadataObjectList = SyncSettingsRegister.GetMetadataList();
		
	Query = New Query;
	Query.Text = 
		"SELECT
		|	SyncSettingsFTP.MetadataObject as MetadataObject 
		|FROM
		|	InformationRegister.SyncSettingsFTP AS SyncSettingsFTP";

	FTPSettingsTable = Query.Execute().Unload();

	For Each Str In MetadataObjectList Do 
				
		SearchStructure = New Structure("MetadataObject", Str.Value);
		SearchRows = FTPSettingsTable.FindRows(SearchStructure);
		
		If SearchRows.Count() < 2 Then 
        	
			CurrentObjectList.Add(Str.Value);
			
		EndIf;
											
	EndDo;
			
	Return CurrentObjectList;
	
EndFunction

&AtClient
Procedure MetadataObjectStartChoice(Item, ChoiceData, StandardProcessing)
	
	StandardProcessing = False;
	
	ListOfMetadataObject = GetObjectNameList(Items.MetadataObject.EditText);
	
	CurrentChoise = ChooseFromList(ListOfMetadataObject, Item);
	
	If Not CurrentChoise = Undefined And ValueIsFilled(CurrentChoise.Value) Then 
		If Not Record.MetadataObject = CurrentChoise.Value Then 
			Record.MetadataObject = CurrentChoise.Value;
		EndIf;
	EndIf;
	
EndProcedure




