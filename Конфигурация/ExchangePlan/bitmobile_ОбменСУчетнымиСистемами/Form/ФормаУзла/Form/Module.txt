
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Объект.Ссылка = ПланыОбмена.bitmobile_ОбменСУчетнымиСистемами.ЭтотУзел() Тогда
		
		ЭтаФорма.ТолькоПросмотр = Истина;
		
		Элементы.ЗагрузитьПравила.Доступность = Ложь;
		
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)
	
	Если ЗначениеЗаполнено(АдресФайла) Тогда
		
		ТекущийОбъект.ПравилаОбмена = Новый ХранилищеЗначения(ПолучитьИзВременногоХранилища(АдресФайла));
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузитьПравила(Команда)
	
	НачатьПомещениеФайла(Новый ОписаниеОповещения("ЗагрузитьПравилаОкончание", ЭтаФорма)
						,
						,
						, Истина
						, ЭтаФорма.УникальныйИдентификатор);
	
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузитьПравилаОкончание(Результат, Адрес, ВыбранноеИмяФайла, ДополнительныеПараметры) Экспорт
	
	Если Не Результат Тогда
		
		Возврат;
		
	КонецЕсли;
	
	АдресФайла = Адрес;
	
КонецПроцедуры

&НаКлиенте
Процедура Диск_КаталогНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	ДиалогВыбораФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.ВыборКаталога);
	
	ДиалогВыбораФайла.Заголовок = НСтр("en = 'Choose a directory'; ru = 'Выберите каталог'");
	ДиалогВыбораФайла.Каталог = Объект.Диск_Каталог;
	ДиалогВыбораФайла.ПроверятьСуществованиеФайла = Истина;
	
	Если ДиалогВыбораФайла.Выбрать() Тогда
		
		Объект.Диск_Каталог = ДиалогВыбораФайла.Каталог;
		
	КонецЕсли;
	
КонецПроцедуры


