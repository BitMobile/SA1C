 
 
 // Параметры:
// ТаблицаТочекДляОтображения: ТаблицаЗначений, 
// 		первая колонка - широта, 
// 		вторая - долгота,
// 		третья - цвет значка строкой (варианты - gray, green, orange, purple, red, 
// 		white, yellow, black, blue, brown), либо адрес значка, начинающийся с http 
// 		четвертая - текст всплывающей подсказки
// 		пятая - навигационная ссылка на объект для открытия
// ПодсказкаПриНаведении: булево - если Истина, то информационное окно отображается при наведении мыши, 
// 		скрывается при уведении курсора, нажатие на значок передается в родительскому полю
//		если Ложь, информационное окно отображается при щелчке ЛКМ, при повторном скрывается.
Функция ПолучитьКартуGoogle(ТаблицаТочекДляОтображения, ПодсказкаПриНаведении =  Истина, АдресСтарта = "Москва") Экспорт
	
	Макет = ЭтотОбъект.ПолучитьМакет("NSI_МакетКартыGoogle");
	
	ТекстКарты = Макет.ПолучитьТекст();
		
	ТекстКарты = СтрЗаменить(ТекстКарты, "geocoder.geocode( { 'address': StartAdress}, function(results, status) {", "geocoder.geocode( { 'address': """ + АдресСтарта + """}, function(results, status) {");
	
	Возврат ТекстКарты;
	
КонецФункции

Функция СоздатьТаблицуДляПередачиКоординат() Экспорт
	
	Таблица = Новый ТаблицаЗначений;
	Таблица.Колонки.Добавить("Широта", Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(20,10)));
	Таблица.Колонки.Добавить("Долгота", Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(20,10)));
	Таблица.Колонки.Добавить("Адрес", Новый ОписаниеТипов("Строка"));
	Таблица.Колонки.Добавить("Цвет", Новый ОписаниеТипов("Строка"));
	Таблица.Колонки.Добавить("Текст", Новый ОписаниеТипов("Строка"));
	Таблица.Колонки.Добавить("НавигационнаяСсылка", Новый ОписаниеТипов("Строка"));
	Возврат Таблица;
	
КонецФункции

