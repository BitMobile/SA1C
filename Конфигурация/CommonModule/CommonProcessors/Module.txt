
Function GetTerritory(Outlet) Export
	
	Query = New Query;
	
	Query.Text = "SELECT ALLOWED TOP 1
				|	TerritoryOutlets.Ref
				|FROM
				|	Catalog.Territory.Outlets AS TerritoryOutlets
				|WHERE
				|	TerritoryOutlets.Outlet = &Outlet";
	
	Query.SetParameter("Outlet", Outlet);
	
	Selection = Query.Execute().Select();
	Selection.Next();
	
	Return Selection.Ref;	
	
EndFunction

Function GetPredefinedItems(PredefinedItems) Export 
	
	ItemsMap = New Map;
	
	For Each Row In PredefinedItems Do
		
		If Row.Key = "Catalog.User" Then
			
			Query = New Query;
			Query.Text = "SELECT ALLOWED
						|	User.Ref AS Ref
						|FROM
						|	Catalog.User AS User
						|WHERE
						|	User.Role = &Role";
			
			Query.SetParameter("Role", "SR");
			
		Else
			
			Query = New Query;
			Query.Text = "SELECT ALLOWED Ref FROM " + Row.Key;
			
		EndIf;
		
		Result = Query.Execute().Unload();
		
		If Result.Count() = 1 Then
			
			ItemsMap.Insert(Row.Value, Result[0].Ref);
			
		EndIf;
		
	EndDo;
	
	Return ItemsMap;
	
EndFunction

Function GetQuestionGroupType(TypeString = "SKUQuestions") Export
	
	If TypeString = "SKUQuestions" Then 
		
		Return Enums.QuestionGroupTypes.SKUQuestions;
		
	Else 
		
		Return Enums.QuestionGroupTypes.RegularQuestions;
		
	EndIf;
	
EndFunction

Function StringToNumber(String) Export
	
	Try
		
		Result = Number(String);
		
	Except
		
		Result = 0;
		
	EndTry;
	
	Return Result;
	
EndFunction



