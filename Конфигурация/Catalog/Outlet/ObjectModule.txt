
Procedure BeforeWrite(Cancel)
	
	ThisObject.AdditionalProperties.Insert("OldStatus", ThisObject.Ref.OutletStatus);
	
EndProcedure

Procedure OnWrite(Cancel)
	
	OldStatus = ThisObject.AdditionalProperties.OldStatus;
	NewStatus = ThisObject.OutletStatus;
	
	StatusChanged = Not OldStatus = NewStatus;
	
	If StatusChanged Then
		
		Record = InformationRegisters.OutletStatusHistory.CreateRecordManager();
		Record.Outlet = ThisObject.Ref;
		Record.Status = ThisObject.OutletStatus;
		Record.Period = CurrentDate();
		Record.Write();
		
	EndIf;
	
EndProcedure

