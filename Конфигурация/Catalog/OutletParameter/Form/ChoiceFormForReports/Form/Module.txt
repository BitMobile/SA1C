
&AtServer
Function GetParameterValues(Parameter)
	
	ReturnValueList = New ValueList;
	
	If TypeOf(Parameter) = Type("CatalogRef.OutletParameter") Then 
		
		Query = New Query;
		Query.Text = 
			"SELECT DISTINCT
			|	OutletParameters.Value AS Value
			|FROM
			|	Catalog.Outlet.Parameters AS OutletParameters
			|WHERE
			|	OutletParameters.Parameter = &Parameter
			|	AND NOT OutletParameters.Value LIKE """"";
		
		Query.SetParameter("Parameter", Parameter);
		
		QueryResult = Query.Execute();
		
		Selection = QueryResult.Select();
		
		While Selection.Next() Do
			
			ReturnValueList.Add(Selection.Value);
			
		EndDo;
	
	EndIf;
	
	Return ReturnValueList;
	
EndFunction

&AtClient
Procedure ListValueChoice(Item, Value, StandardProcessing)
	
	OwnerForm = Undefined;
	
	GetOwner(ThisForm.FormOwner, OwnerForm);
	
	If Not OwnerForm = Undefined Then 
		
		Try
		
			If OwnerForm.FormName = "Report.PromoActionsReport.Form" Or OwnerForm.FormName = "Report.PromoActionsReport.SettingsForm"
				Or OwnerForm.FormName = "Report.OutletAssortmentAvailability.Form.ReportForm" Or OwnerForm.FormName = "Report.OutletAssortmentAvailability.SettingsForm"
				Or OwnerForm.FormName = "Report.OutletPhotosReport.Form.ReportForm" Or OwnerForm.FormName = "Report.OutletPhotosReport.SettingsForm"
				Or OwnerForm.FormName = "Report.PlanFactSKUStockReport.Form.ReportForm" Or OwnerForm.FormName = "Report.PlanFactSKUStockReport.SettingsForm"
				Or OwnerForm.FormName = "Report.PriceMonitoring.Form" Or OwnerForm.FormName = "Report.PriceMonitoring.SettingsForm"
				Or OwnerForm.FormName = "Report.ShelfSpaceShare.Form" Or OwnerForm.FormName = "Report.ShelfSpaceShare.SettingsForm"
				Or OwnerForm.FormName = "Report.SKUsStockInOutlet.ObjectForm" Or OwnerForm.FormName = "Report.SKUsStockInOutlet.SettingsForm" Then 
				
				OwnerForm.Report.SettingsComposer.Settings.FilterAvailableFields.Items.Find("Value").AvailableValues = GetParameterValues(Value);
				
			EndIf;
			
		Except
			
		EndTry;
		
	EndIf;
	
EndProcedure

&AtClient
Procedure GetOwner(Owner, OwnerForm)
	
	If Not TypeOf(Owner) = Type("ManagedForm") Then 
		
		GetOwner(Owner.Parent, OwnerForm);
		
	Else 
		
		OwnerForm = Owner;
		
	EndIf;
	
EndProcedure