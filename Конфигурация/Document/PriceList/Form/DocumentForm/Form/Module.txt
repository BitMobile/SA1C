
#Region CommonProcedureAndFunctions

&AtServer
Procedure FillSKUServer()
	
	FormObject = FormDataToValue(Object, Type("DocumentObject.PriceList"));
	
	Query = New Query;
	Query.Text = 
		"SELECT ALLOWED
		|	SKU.Ref
		|FROM
		|	Catalog.SKU AS SKU
		|WHERE
		|	NOT SKU.Ref IN (&SKUArray)";
		
	Query.SetParameter("SKUArray", FormObject.Prices.UnloadColumn("SKU"));
	
	Result = Query.Execute().Unload();
	
	For Each Value In Result Do
		
		NewRow = Object.Prices.Add();
		NewRow.SKU = Value.Ref;
		
	EndDo;
	
EndProcedure

#EndRegion

#Region UserInterface

&AtClient
Procedure FillSKU(Command)
    
    FillSKUServer();

EndProcedure

&AtClient
Procedure SKUSKUOnChange(Item)
   
    requestMap = New Map;
    requestMap.Insert("pName", "SKU");
    requestMap.Insert("checkingItem", Items.SKU.CurrentData);
    requestMap.Insert("tabularSection", Object.Prices);
    
    ClientProcessors.UniqueRows(requestMap); 
    
EndProcedure

#EndRegion








